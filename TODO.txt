re-write tests
address comments
